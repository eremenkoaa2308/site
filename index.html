<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RND AWARDS 2025</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <header>
        <div class="container header-inner">
            <a href="#" class="logo">RND<span>.</span></a>
            <nav>
                <ul>
                    <li><a href="#" class="active">–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</a></li>
                    <li><a href="#results">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a></li>
                    <li><a href="#admin">–î–ª—è –∞–¥–º–∏–Ω–∞</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
    <section class="hero">
        <div class="container">
            <h1>RND AWARDS 2025</h1>
            <p>–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –∑–∞ –ª—É—á—à–∏—Ö –ø–∞—Ü–∞–Ω–æ–≤ 2025 –≥–æ–¥–∞</p>
            <a href="#vote" class="btn">–ì–û–õ–û–°–û–í–ê–¢–¨ –°–ï–ô–ß–ê–°</a>
            <a href="#results" class="btn btn-secondary">–†–ï–ó–£–õ–¨–¢–ê–¢–´</a>
        </div>
    </section>

    <!-- –§–æ—Ä–º–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è -->
    <div class="container">
        <div class="vote-form" id="vote">
            <h2>–í–´–ë–ï–†–ò –ü–û–ë–ï–î–ò–¢–ï–õ–ï–ô –í 12 –ù–û–ú–ò–ù–ê–¶–ò–Ø–•</h2>
            
            <!-- –ù–æ–º–∏–Ω–∞—Ü–∏–∏ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ -->
            <div id="nominationsContainer">
                <!-- –ù–æ–º–∏–Ω–∞—Ü–∏–∏ –±—É–¥—É—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
            
            <div class="form-buttons">
                <button onclick="saveVote()" class="btn">–°–û–•–†–ê–ù–ò–¢–¨ –ì–û–õ–û–°</button>
                <button onclick="clearVote()" class="btn btn-secondary">–û–ß–ò–°–¢–ò–¢–¨ –§–û–†–ú–£</button>
                <button onclick="exportMyVote()" class="btn" style="background: #4CAF50;">üì• –°–ö–ê–ß–ê–¢–¨ –ú–û–ô –ì–û–õ–û–°</button>
                <button onclick="shareMyVote()" class="btn" style="background: #2196F3;">üì§ –û–¢–ü–†–ê–í–ò–¢–¨ –ê–î–ú–ò–ù–£</button>
            </div>
            
            <div id="message" class="message"></div>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è -->
        <div class="results" id="results">
            <h2 style="color: red; margin: 40px 0 20px 0;">–†–ï–ó–£–õ–¨–¢–ê–¢–´ –ì–û–õ–û–°–û–í–ê–ù–ò–Ø</h2>
            <div id="resultsContainer">
                <p style="text-align: center; color: #888; padding: 20px;">
                    –ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
                </p>
            </div>
        </div>

        <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
        <div class="admin-panel" id="admin">
            <h3>üìä –ü–ê–ù–ï–õ–¨ –°–ë–û–†–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í</h3>
            <p style="text-align: center; color: #ccc; margin-bottom: 20px;">
                –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞: —Å–æ–±–∏—Ä–∞–π—Ç–µ –≥–æ–ª–æ—Å–∞ –æ—Ç –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
            </p>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>–ú–æ–π –≥–æ–ª–æ—Å</h4>
                    <div class="stat-number" id="myVotesCount">0</div>
                    <button onclick="exportMyVote()" class="btn" style="width: 100%; margin: 5px 0;">–°–∫–∞—á–∞—Ç—å</button>
                </div>
                
                <div class="stat-card">
                    <h4>–õ–æ–∫–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
                    <div class="stat-number" id="localStatsCount">0</div>
                    <button onclick="exportAllStats()" class="btn" style="width: 100%; margin: 5px 0;">–≠–∫—Å–ø–æ—Ä—Ç</button>
                </div>
                
                <div class="stat-card">
                    <h4>–ó–∞–≥—Ä—É–∑–∏—Ç—å –≥–æ–ª–æ—Å–∞</h4>
                    <input type="file" id="voteFiles" accept=".json" style="width: 100%; margin: 10px 0; padding: 10px; background: #333; color: white; border-radius: 5px;">
                    <button onclick="loadVotesFromFile()" class="btn" style="width: 100%;">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</button>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button onclick="showCombinedResults()" class="btn btn-secondary" style="margin: 5px;">–û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤—Å–µ</button>
                <button onclick="clearAllData()" class="btn" style="background: #f44336; margin: 5px;">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</button>
            </div>
            
            <div id="adminMessage" class="message" style="margin-top: 20px;"></div>
        </div>
    </div>

    <!-- –ü–æ–¥–≤–∞–ª -->
    <footer>
        <div class="container">
            <p>¬© RND 2025</p>
        </div>
    </footer>

    <script>
    // –¢–≤–æ–π JavaScript –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    // –î–∞–Ω–Ω—ã–µ –Ω–æ–º–∏–Ω–∞—Ü–∏–π —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
    const nominationsData = [
        {
            id: 1,
            title: "1. RND-KING",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        },
        {
            id: 2,
            title: "2. –ê–§–ö RND –≥–æ–¥–∞",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        },
	{
            id: 3,
            title: "3. –î–æ—Ç–µ—Ä –≥–æ–¥–∞",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        },
	{
            id: 4,
            title: "4. –ó–∞–≤–æ–∑ –≥–æ–¥–∞",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        },
	{
            id: 5,
            title: "5. –•–∞—Ä–∏–∑–º–∞ –≥–æ–¥–∞",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        },
	{
            id: 6,
            title: "6. –ó–∞—à–∫–≤–∞—Ä –≥–æ–¥–∞",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        },
	{
            id: 7,
            title: "7. RND –¥–æ–±—Ä—è–∫",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        },
	{
            id: 8,
            title: "8. RND –ó–ª–æ–¥–µ–π",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        },
	{
            id: 9,
            title: "9. –ü—Ä–æ—Ä—ã–≤ –≥–æ–¥–∞",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        },
	{
            id: 10,
            title: "10. –•–µ–π—Ç –≥–æ–¥–∞",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        },
	{
            id: 11,
            title: "11. RND QUEEN",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        },
        {
            id: 12,
            title: "12. RND-ELDER KING",
            candidates: [
                { name: "–ü–∞—Ü–∞–Ω 1", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 2", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 3", photo: "pictures/nomination1_1.png" },
                { name: "–ü–∞—Ü–∞–Ω 4", photo: "pictures/nomination1_1.png" }
            ]
        }
    ];

    // === –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ===
    
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–º–∏–Ω–∞—Ü–∏–∏ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
    function loadNominations() {
        const container = document.getElementById('nominationsContainer');
        let html = '';
        
        nominationsData.forEach(nomination => {
            html += `
                <div class="nomination" data-nomination-id="${nomination.id}">
                    <label>${nomination.title}</label>
                    <div class="candidates-grid" id="grid-${nomination.id}">
            `;
            
            nomination.candidates.forEach((candidate, index) => {
                html += `
                    <div class="candidate-item" onclick="selectCandidate(${nomination.id}, ${index})" 
                         data-nomination="${nomination.id}" data-candidate="${index}">
                        <img src="${candidate.photo}" alt="${candidate.name}" class="candidate-img" 
                             onerror="this.src='https://via.placeholder.com/200x180/333/fff?text=–§–æ—Ç–æ'">
                        <div class="candidate-name">${candidate.name}</div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                    <div class="nomination-input">
                        <input type="text" id="custom-n${nomination.id}" 
                               placeholder="–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –¥—Ä—É–≥–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞">
                        <button onclick="addCustomCandidate(${nomination.id})" class="custom-candidate-btn">
                            –í—ã–±—Ä–∞—Ç—å
                        </button>
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = html;
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤—ã–±–æ—Ä—ã
        loadSavedVotes();
    }
    
    // –í—ã–±—Ä–∞—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –ø–æ —Ñ–æ—Ç–æ
    function selectCandidate(nominationId, candidateIndex) {
        const nomination = nominationsData.find(n => n.id === nominationId);
        const candidate = nomination.candidates[candidateIndex];
        
        // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —É –≤—Å–µ—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –≤ —ç—Ç–æ–π –Ω–æ–º–∏–Ω–∞—Ü–∏–∏
        document.querySelectorAll(`.candidate-item[data-nomination="${nominationId}"]`).forEach(item => {
            item.classList.remove('selected');
        });
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –∫–∞–Ω–¥–∏–¥–∞—Ç—É
        const selectedItem = document.querySelector(`.candidate-item[data-nomination="${nominationId}"][data-candidate="${candidateIndex}"]`);
        selectedItem.classList.add('selected');
        
        // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
        document.getElementById(`custom-n${nominationId}`).value = candidate.name;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
        saveVoteToStorage(nominationId, candidate.name);
    }
    
    // –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–µ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
    function addCustomCandidate(nominationId) {
        const input = document.getElementById(`custom-n${nominationId}`);
        const candidateName = input.value.trim();
        
        if (!candidateName) {
            showMessage('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞!', 'error');
            return;
        }
        
        // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —É –≤—Å–µ—Ö —Ñ–æ—Ç–æ–∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
        document.querySelectorAll(`.candidate-item[data-nomination="${nominationId}"]`).forEach(item => {
            item.classList.remove('selected');
        });
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
        saveVoteToStorage(nominationId, candidateName);
        showMessage(`–í—ã–±—Ä–∞–Ω "${candidateName}"`, 'success');
    }
    
    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≥–æ–ª–æ—Å –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    function saveVoteToStorage(nominationId, candidateName) {
        let votes = JSON.parse(localStorage.getItem('rndVotes') || '{}');
        votes[`n${nominationId}`] = candidateName;
        localStorage.setItem('rndVotes', JSON.stringify(votes));
        updateStats();
    }
    
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≥–æ–ª–æ—Å–∞
    function loadSavedVotes() {
        const votes = JSON.parse(localStorage.getItem('rndVotes') || '{}');
        
        Object.keys(votes).forEach(key => {
            const nominationId = parseInt(key.replace('n', ''));
            const candidateName = votes[key];
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
            const input = document.getElementById(`custom-n${nominationId}`);
            if (input) {
                input.value = candidateName;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ç–∞–∫–æ–π –∫–∞–Ω–¥–∏–¥–∞—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö
            const nomination = nominationsData.find(n => n.id === nominationId);
            if (nomination) {
                const candidateIndex = nomination.candidates.findIndex(c => c.name === candidateName);
                if (candidateIndex !== -1) {
                    // –í—ã–¥–µ–ª—è–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é
                    const candidateItem = document.querySelector(`.candidate-item[data-nomination="${nominationId}"][data-candidate="${candidateIndex}"]`);
                    if (candidateItem) {
                        candidateItem.classList.add('selected');
                    }
                }
            }
        });
        
        updateStats();
    }
    
    // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    function updateStats() {
        const votes = JSON.parse(localStorage.getItem('rndVotes') || '{}');
        const voteCount = Object.keys(votes).length;
        document.getElementById('myVotesCount').textContent = voteCount;
        document.getElementById('localStatsCount').textContent = voteCount;
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
    function showMessage(text, type = 'info') {
        const msg = document.getElementById('message');
        msg.innerHTML = text;
        msg.className = `message ${type}`;
        msg.style.display = 'block';

        if (type !== 'error') {
            setTimeout(() => msg.style.display = 'none', 5000);
        }
    }
    
    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≥–æ–ª–æ—Å (–æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä)
    async function saveVote() {
        const votes = JSON.parse(localStorage.getItem('rndVotes') || '{}');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ 12 –Ω–æ–º–∏–Ω–∞—Ü–∏–π –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
        let allFilled = true;
        for (let i = 1; i <= 12; i++) {
            if (!votes[`n${i}`]) {
                allFilled = false;
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –Ω–µ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—É—é –Ω–æ–º–∏–Ω–∞—Ü–∏—é
                const nomElement = document.querySelector(`[data-nomination-id="${i}"]`);
                if (nomElement) {
                    nomElement.style.borderLeftColor = '#ff4444';
                    nomElement.style.animation = 'none';
                    setTimeout(() => {
                        nomElement.style.animation = 'pulse 0.5s';
                    }, 10);
                }
            }
        }
        
        if (!allFilled) {
            showMessage('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –Ω–æ–º–∏–Ω–∞—Ü–∏–∏!', 'error');
            return;
        }
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É
        document.querySelectorAll('.nomination').forEach(nom => {
            nom.style.borderLeftColor = 'red';
            nom.style.animation = 'none';
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
        const submitBtn = document.querySelector('button[onclick="saveVote()"]');
        const originalText = submitBtn.textContent;
        submitBtn.textContent = '–û—Ç–ø—Ä–∞–≤–ª—è–µ–º...';
        submitBtn.disabled = true;
        
        try {
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ API (—Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)
            const response = await fetch('/api/vote', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(votes)
            });
            
            const result = await response.json();
            
            if (response.ok) {
                showMessage(`‚úÖ –ì–æ–ª–æ—Å —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω! ID: ${result.voter_token}`, 'success');
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                loadResults();
            } else {
                showMessage(`‚ùå –û—à–∏–±–∫–∞: ${result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`, 'error');
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏:', error);
            showMessage('‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error');
        } finally {
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
        }
    }
    
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    async function loadResults() {
        try {
            const response = await fetch('/api/vote');
            if (!response.ok) {
                throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
            }
            const data = await response.json();
            displayResults(data);
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:', error);
            document.getElementById('resultsContainer').innerHTML = 
                '<p style="color: #888; text-align: center; padding: 30px;">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...</p>';
        }
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    function displayResults(data) {
        const container = document.getElementById('resultsContainer');
        
        if (!data || !data.results || data.results.length === 0) {
            container.innerHTML = '<p style="color: #888; text-align: center; padding: 30px;">–ì–æ–ª–æ—Å–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
            return;
        }
        
        let html = `
            <div style="background: #222; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h3 style="color: red; margin-bottom: 10px;">üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ì–û–õ–û–°–û–í–ê–ù–ò–Ø</h3>
                <p style="color: #ccc;">–í—Å–µ–≥–æ –≥–æ–ª–æ—Å–æ–≤: <strong>${data.total}</strong></p>
                <p style="color: #888; font-size: 14px;">–û–±–Ω–æ–≤–ª–µ–Ω–æ: ${new Date().toLocaleTimeString()}</p>
            </div>
        `;
        
        // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –Ω–æ–º–∏–Ω–∞—Ü–∏—è–º
        const byNomination = {};
        data.results.forEach(item => {
            if (!byNomination[item.nomination]) {
                byNomination[item.nomination] = [];
            }
            byNomination[item.nomination].push(item);
        });
        
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞–∂–¥—É—é –Ω–æ–º–∏–Ω–∞—Ü–∏—é
        Object.keys(byNomination).forEach(nom => {
            const items = byNomination[nom];
            const maxVotes = Math.max(...items.map(i => i.vote_count));
            
            html += `
                <div class="result-item" style="background: #111; padding: 20px; margin-bottom: 20px; border-radius: 10px; border-left: 4px solid red;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #333;">
                        <h4 style="color: white;">${nom}</h4>
                        <span style="color: #ccc;">${items.reduce((sum, i) => sum + i.vote_count, 0)} –≥–æ–ª–æ—Å–æ–≤</span>
                    </div>
            `;
            
            items.forEach(item => {
                const percent = maxVotes > 0 ? (item.vote_count / maxVotes) * 100 : 0;
                html += `
                    <div style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="color: white;">${item.candidate}</span>
                            <span style="color: #ccc;">${item.vote_count}</span>
                        </div>
                        <div style="height: 20px; background: #222; border-radius: 10px; overflow: hidden; margin-bottom: 15px;">
                            <div style="height: 100%; background: red; width: ${percent}%; transition: width 1s;"></div>
                        </div>
                    </div>
                `;
            });
            
            html += `</div>`;
        });
        
        container.innerHTML = html;
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–ª–æ—Å–æ–∫
        setTimeout(() => {
            container.querySelectorAll('div[style*="width:"]').forEach(fill => {
                const width = fill.style.width;
                fill.style.width = '0%';
                setTimeout(() => fill.style.width = width, 50);
            });
        }, 100);
    }
    
    // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
    function clearVote() {
        // –û—á–∏—â–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
        document.querySelectorAll('.candidate-item').forEach(item => {
            item.classList.remove('selected');
        });
        
        // –û—á–∏—â–∞–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞
        for (let i = 1; i <= 12; i++) {
            const input = document.getElementById(`custom-n${i}`);
            if (input) {
                input.value = '';
            }
        }
        
        // –û—á–∏—â–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
        localStorage.removeItem('rndVotes');
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É
        document.querySelectorAll('.nomination').forEach(nom => {
            nom.style.borderLeftColor = 'red';
        });
        
        updateStats();
        showMessage('–§–æ—Ä–º–∞ –æ—á–∏—â–µ–Ω–∞', 'success');
    }
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    function exportMyVote() {
        const votes = JSON.parse(localStorage.getItem('rndVotes') || '{}');
        if (Object.keys(votes).length === 0) {
            showMessage('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞', 'error');
            return;
        }
        
        const dataStr = JSON.stringify(votes, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = `rnd_vote_${new Date().toISOString().slice(0,10)}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showMessage('–ì–æ–ª–æ—Å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ JSON', 'success');
    }
    
    function shareMyVote() {
        const votes = JSON.parse(localStorage.getItem('rndVotes') || '{}');
        if (Object.keys(votes).length === 0) {
            showMessage('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏', 'error');
            return;
        }
        
        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        showMessage('–§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ', 'info');
    }
    
    function exportAllStats() {
        showMessage('–§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ', 'info');
    }
    
    function loadVotesFromFile() {
        const fileInput = document.getElementById('voteFiles');
        if (!fileInput.files.length) {
            showMessage('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏', 'error');
            return;
        }
        
        const file = fileInput.files[0];
        const reader = new FileReader();
        
        reader.onload = function(e) {
            try {
                const votes = JSON.parse(e.target.result);
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤
                showMessage('–§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
            } catch (error) {
                showMessage('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞', 'error');
            }
        };
        
        reader.readAsText(file);
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', function() {
        loadNominations();
        loadResults();
    });
    </script>
</body>
</html>